"use strict";(self.webpackChunkmomento_docs=self.webpackChunkmomento_docs||[]).push([[5454],{5167:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>h,contentTitle:()=>o,default:()=>g,frontMatter:()=>c,metadata:()=>l,toc:()=>d});var n=t(4848),i=t(8453),s=(t(1470),t(9365),t(2480)),r=(t(1441),t(5347));const c={sidebar_position:1,title:"Database Caching Pattern",sidebar_label:"Database Caching",description:"Learn best practices using Momento cache with your database",keywords:["development patterns","momento","cache","database","enterprise patterns"]},o="Use Momento Cache to speed up your database",l={id:"cache/patterns/database-caching",title:"Database Caching Pattern",description:"Learn best practices using Momento cache with your database",source:"@site/docs/cache/patterns/database-caching.mdx",sourceDirName:"cache/patterns",slug:"/cache/patterns/database-caching",permalink:"/cache/patterns/database-caching",draft:!1,unlisted:!1,editUrl:"https://github.com/momentohq/public-dev-docs/tree/main/docs/cache/patterns/database-caching.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Database Caching Pattern",sidebar_label:"Database Caching",description:"Learn best practices using Momento cache with your database",keywords:["development patterns","momento","cache","database","enterprise patterns"]},sidebar:"tutorialSidebar",previous:{title:"Patterns"},next:{title:"API Caching",permalink:"/cache/patterns/api-caching"}},h={},d=[{value:"Read-aside caching",id:"read-aside-caching",level:2},{value:"Advantages of read-aside caching",id:"advantages-of-read-aside-caching",level:3},{value:"Read-aside caching with Momento",id:"read-aside-caching-with-momento",level:3},{value:"Disadvantages of read-aside caching",id:"disadvantages-of-read-aside-caching",level:3},{value:"Write-through caching",id:"write-through-caching",level:2},{value:"Advantages of write-through caching",id:"advantages-of-write-through-caching",level:3},{value:"Write-through caching with Momento",id:"write-through-caching-with-momento",level:3},{value:"Disadvantages of write-through caching",id:"disadvantages-of-write-through-caching",level:3},{value:"Learn more",id:"learn-more",level:2}];function u(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.h1,{id:"use-momento-cache-to-speed-up-your-database",children:"Use Momento Cache to speed up your database"}),"\n",(0,n.jsx)(a.p,{children:"Using a cache alongside your database can significantly improve the performance and availability of your application. By storing frequently accessed data in a cache, you can reduce the load on the database, leading to faster response times, higher availability, and lower costs."}),"\n",(0,n.jsxs)(a.p,{children:["There are multiple ways to use a cache in conjunction with a database. The 2 main patterns are ",(0,n.jsx)(a.code,{children:"read-aside"})," and ",(0,n.jsx)(a.code,{children:"write-through"})," caching. In this guide, we will explore these patterns and how to implement them using Momento Cache."]}),"\n",(0,n.jsx)(a.admonition,{type:"info",children:(0,n.jsxs)(a.p,{children:["With any caching pattern, it is important to tune the ",(0,n.jsx)(a.a,{href:"../learn/how-it-works/cache-eviction-vs-expiration",children:"TTL (Time to Live)"})," for cached items. The TTL determines how long the data will be stored in the cache before it is evicted. Setting an appropriate TTL can help you ensure the data in the cache is up-to-date. Picking a TTL that is too short can result in ",(0,n.jsx)(a.a,{href:"https://www.gomomento.com/blog/the-biggest-miss-in-your-cache-hit-rate",children:"frequent cache misses"}),", while a TTL that is too long can result in stale data being served. Determining the appropriate TTL should be is dependent on your application, data being cached, and how that data is used."]})}),"\n",(0,n.jsx)(a.h2,{id:"read-aside-caching",children:"Read-aside caching"}),"\n",(0,n.jsx)(a.p,{children:"Read-aside caching is a pattern where the application first checks the cache for the data it needs. If the data is not found in the cache, the application fetches the data from the database and stores it in the cache for future use. This pattern is useful for read-heavy applications where the same data is accessed frequently."}),"\n",(0,n.jsx)(a.h3,{id:"advantages-of-read-aside-caching",children:"Advantages of read-aside caching"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Faster reads"}),": Assuming a high cache hit rate, most requests won't need to hit the database, resulting in faster reads."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Higher availability"}),": Read-aside caching reduces the load on the database, which can help improve the availability of the application."]}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"Diagram of read-aside caching with Momento",src:t(4445).A+"",width:"1734",height:"1118"})}),"\n",(0,n.jsx)(a.h3,{id:"read-aside-caching-with-momento",children:"Read-aside caching with Momento"}),"\n",(0,n.jsxs)(a.p,{children:["Momento makes it easy to implement read-aside caching in your application. You can use the ",(0,n.jsx)(a.code,{children:"get"})," API to fetch data from the cache and the ",(0,n.jsx)(a.code,{children:"set"})," API to save data in the cache."]}),"\n",(0,n.jsx)(r.r,{js:"const cachedValue = (await cacheClient.get('test-cache', 'test-key')).value();\nif (cachedValue !== undefined) {\n  console.log(`Cache hit for key 'test-key': ${cachedValue}`);\n  return cachedValue;\n} else {\n  console.log(\"Key 'test-key' was not found in cache 'test-cache', checking in database...\");\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const actualValue = database.get('test-key')!;\n  await cacheClient.set('test-cache', 'test-key', actualValue);\n  return actualValue;\n}",python:'get_response = await cache_client.get("test-cache", "test-key")\nmatch get_response:\n    case CacheGet.Hit() as hit:\n        print(f"Retrieved value for key \'test-key\': {hit.value_string}")\n        return\nprint(f"cache miss, fetching from database")\nactual_value = database.get("test-key")\nawait cache_client.set("test-cache", "test-key", actual_value)\nreturn\n',java:"",kotlin:"",go:'key := uuid.NewString()\nresp, err := client.Get(ctx, &momento.GetRequest{\n\tCacheName: "cache-name",\n\tKey:       momento.String(key),\n})\nif err != nil {\n\tpanic(err)\n}\n\nswitch r := resp.(type) {\n// cache hit\ncase *responses.GetHit:\n\treturn r.ValueString()\n}\n// lookup value in database\nval := database[key]\nclient.Set(ctx, &momento.SetRequest{\n\tCacheName: "cache-name",\n\tKey:       momento.String(key),\n\tValue:     momento.String(val),\n})\nreturn val',csharp:"",php:"",rust:"",elixir:"",swift:"",dart:"",ts:""}),"\n",(0,n.jsx)(a.h3,{id:"disadvantages-of-read-aside-caching",children:"Disadvantages of read-aside caching"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Cache misses"}),": If data is not properly set in the cache, then high cache misses would result in an extra api call, which could slow down the application."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Stale data"}),": If the data in the database is updated frequently, the cache may contain stale data. This can be mitigated by setting an appropriate TTL for the cached items."]}),"\n"]}),"\n",(0,n.jsx)(a.h2,{id:"write-through-caching",children:"Write-through caching"}),"\n",(0,n.jsx)(a.p,{children:"Write-through caching is a pattern where the application writes data to the cache and the database at the same time. This pattern is useful for write-heavy applications where the same data is written frequently. It is often used in conjunction with read-aside caching. Since the data is written to the cache and the database at the same time, the cache is always up-to-date with the database, resulting in a higher cache hit rate, faster reads, and lower latency."}),"\n",(0,n.jsx)(a.h3,{id:"advantages-of-write-through-caching",children:"Advantages of write-through caching"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Higher cache hit rates"}),": Since the cache is kept up to date with the database, most requests to the cache should result in a cache hit."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Lower latency"}),": Higher cache hit rates means less calls to the database, resulting in lower latency."]}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.img,{alt:"Diagram of write-through caching with Momento",src:t(3973).A+"",width:"1728",height:"1098"})}),"\n",(0,n.jsx)(a.h3,{id:"write-through-caching-with-momento",children:"Write-through caching with Momento"}),"\n",(0,n.jsx)(a.p,{children:"Here is an example of how you can implement write-through caching with Momento:"}),"\n",(0,n.jsx)(r.r,{js:"const value = 'test-value';\ndatabase.set('test-key', value);\nawait cacheClient.set('test-cache', 'test-key', value);\nreturn value;",python:'database.set("test-key", "test-value")\nset_response = await cache_client.set("test-cache", "test-key", "test-value")\nreturn\n',java:"",kotlin:"",go:'key := uuid.NewString()\nvalue := uuid.NewString()\n// set value in database\ndatabase[key] = value\n// set value in cache\nclient.Set(ctx, &momento.SetRequest{\n\tCacheName: "cache-name",\n\tKey:       momento.String(key),\n\tValue:     momento.String(value),\n})',csharp:"",php:"",rust:"",elixir:"",swift:"",dart:"",ts:""}),"\n",(0,n.jsx)(a.h3,{id:"disadvantages-of-write-through-caching",children:"Disadvantages of write-through caching"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Infrequently accessed data"}),": If data is written to the cache that is infrequently accessed, it can result in unnecessary resources needed for the cache, and increased costs. This can be mitigated by using a heuristic to determine which data should be cached."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Performance overhead"}),": Since every write operation needs to be performed twice (once in the cache and once in the persistent storage), there is additional overhead compared to other caching patterns. This can lead to increased latency and reduced throughput for write operations, especially if the underlying storage is relatively slow or experiences high load."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Potential for consistency issues"}),": While write-through caching aims to maintain consistency between the cache and persistent storage, there is still a possibility of consistency issues arising due to factors such as network failures, storage system failures, or race conditions. Proper error handling and retry mechanisms need to be implemented to mitigate these risks."]}),"\n"]}),"\n",(0,n.jsx)(a.h2,{id:"learn-more",children:"Learn more"}),"\n",(0,n.jsx)(a.p,{children:"To learn more about Momento or to get a quick-start on your project, check out some additional resources below."}),"\n",(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"20px",marginBottom:"20px"},children:[(0,n.jsx)(s.A,{title:"More about caching patterns",link:"https://docs.momentohq.com/cache/introduction/common-caching-patterns",description:"Learn more about common caching patterns and how to use them in your application"}),(0,n.jsx)(s.A,{title:"Caching Strategies",link:"https://docs.momentohq.com/cache/introduction/common-caching-strategies",description:"Different levels and layers of caching used throughout your application"})]})]})}function g(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},9365:(e,a,t)=>{t.d(a,{A:()=>r});t(6540);var n=t(4164);const i={tabItem:"tabItem_Ymn6"};var s=t(4848);function r(e){let{children:a,hidden:t,className:r}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,n.A)(i.tabItem,r),hidden:t,children:a})}},1470:(e,a,t)=>{t.d(a,{A:()=>j});var n=t(6540),i=t(4164),s=t(3104),r=t(6347),c=t(205),o=t(7485),l=t(1682),h=t(679);function d(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:a}=e;return!!a&&"object"==typeof a&&"value"in a}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:a,children:t}=e;return(0,n.useMemo)((()=>{const e=a??function(e){return d(e).map((e=>{let{props:{value:a,label:t,attributes:n,default:i}}=e;return{value:a,label:t,attributes:n,default:i}}))}(t);return function(e){const a=(0,l.X)(e,((e,a)=>e.value===a.value));if(a.length>0)throw new Error(`Docusaurus error: Duplicate values "${a.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[a,t])}function g(e){let{value:a,tabValues:t}=e;return t.some((e=>e.value===a))}function p(e){let{queryString:a=!1,groupId:t}=e;const i=(0,r.W6)(),s=function(e){let{queryString:a=!1,groupId:t}=e;if("string"==typeof a)return a;if(!1===a)return null;if(!0===a&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:a,groupId:t});return[(0,o.aZ)(s),(0,n.useCallback)((e=>{if(!s)return;const a=new URLSearchParams(i.location.search);a.set(s,e),i.replace({...i.location,search:a.toString()})}),[s,i])]}function m(e){const{defaultValue:a,queryString:t=!1,groupId:i}=e,s=u(e),[r,o]=(0,n.useState)((()=>function(e){let{defaultValue:a,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!g({value:a,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${a}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return a}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:a,tabValues:s}))),[l,d]=p({queryString:t,groupId:i}),[m,b]=function(e){let{groupId:a}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(a),[i,s]=(0,h.Dv)(t);return[i,(0,n.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:i}),f=(()=>{const e=l??m;return g({value:e,tabValues:s})?e:null})();(0,c.A)((()=>{f&&o(f)}),[f]);return{selectedValue:r,selectValue:(0,n.useCallback)((e=>{if(!g({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),b(e)}),[d,b,s]),tabValues:s}}var b=t(2303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=t(4848);function x(e){let{className:a,block:t,selectedValue:n,selectValue:r,tabValues:c}=e;const o=[],{blockElementScrollPositionUntilNextRender:l}=(0,s.a_)(),h=e=>{const a=e.currentTarget,t=o.indexOf(a),i=c[t].value;i!==n&&(l(a),r(i))},d=e=>{let a=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;a=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;a=o[t]??o[o.length-1];break}}a?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},a),children:c.map((e=>{let{value:a,label:t,attributes:s}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:n===a?0:-1,"aria-selected":n===a,ref:e=>o.push(e),onKeyDown:d,onClick:h,...s,className:(0,i.A)("tabs__item",f.tabItem,s?.className,{"tabs__item--active":n===a}),children:t??a},a)}))})}function w(e){let{lazy:a,children:t,selectedValue:i}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(a){const e=s.find((e=>e.props.value===i));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map(((e,a)=>(0,n.cloneElement)(e,{key:a,hidden:e.props.value!==i})))})}function y(e){const a=m(e);return(0,v.jsxs)("div",{className:(0,i.A)("tabs-container",f.tabList),children:[(0,v.jsx)(x,{...a,...e}),(0,v.jsx)(w,{...a,...e})]})}function j(e){const a=(0,b.A)();return(0,v.jsx)(y,{...e,children:d(e.children)},String(a))}},2480:(e,a,t)=>{t.d(a,{A:()=>h});t(6540);const n="card_Yy4i",i="cardLink_tPnZ",s="cardContent_l93Q",r="cardTitle_gz5m",c="cardDescription_RQFX",o="cardBody_MLn8";var l=t(4848);const h=e=>{let{title:a,description:t,link:h,icon:d,variation:u="normal"}=e,g="",p="";if("dense"===u.toLowerCase())g="0",p="15em";return(0,l.jsx)("div",{className:n,style:{width:p},children:(0,l.jsx)("a",{href:h,target:"_blank",className:i,children:(0,l.jsxs)("div",{className:o,children:[d&&(0,l.jsx)("img",{src:d,height:"32px",width:"32px"}),(0,l.jsxs)("div",{className:s,children:[(0,l.jsx)("h3",{className:r,children:a}),(0,l.jsx)("p",{className:c,style:{marginBottom:g},children:t})]})]})})})}},1441:(e,a,t)=>{t(6540)},5347:(e,a,t)=>{t.d(a,{r:()=>c});var n=t(1470),i=t(9365),s=t(1432),r=(t(6540),t(4848));const c=e=>{let{js:a,python:t,java:c,kotlin:o,go:l,csharp:h,php:d,rust:u,ruby:g,elixir:p,swift:m,dart:b,cli:f}=e;return a||t||c||o||l||h||d||u||g||p||m||b||f?(0,r.jsxs)(n.A,{children:[a&&(0,r.jsx)(i.A,{value:"js",label:"JavaScript",children:(0,r.jsx)(s.A,{language:"js",children:a})}),t&&(0,r.jsx)(i.A,{value:"python",label:"Python",children:(0,r.jsx)(s.A,{language:"python",children:t})}),c&&(0,r.jsx)(i.A,{value:"java",label:"Java",children:(0,r.jsx)(s.A,{language:"java",children:c})}),o&&(0,r.jsx)(i.A,{value:"kotlin",label:"Kotlin",children:(0,r.jsx)(s.A,{language:"kotlin",children:o})}),l&&(0,r.jsx)(i.A,{value:"go",label:"Go",children:(0,r.jsx)(s.A,{language:"go",children:l})}),h&&(0,r.jsx)(i.A,{value:"csharp",label:"C#",children:(0,r.jsx)(s.A,{language:"csharp",children:h})}),d&&(0,r.jsx)(i.A,{value:"php",label:"PHP",children:(0,r.jsx)(s.A,{language:"php",children:d})}),u&&(0,r.jsx)(i.A,{value:"rust",label:"Rust",children:(0,r.jsx)(s.A,{language:"rust",children:u})}),g&&(0,r.jsx)(i.A,{value:"ruby",label:"Ruby",children:(0,r.jsx)(s.A,{language:"ruby",children:g})}),p&&(0,r.jsx)(i.A,{value:"elixir",label:"Elixir",children:(0,r.jsx)(s.A,{language:"elixir",children:p})}),m&&(0,r.jsx)(i.A,{value:"swift",label:"Swift",children:(0,r.jsx)(s.A,{language:"swift",children:m})}),b&&(0,r.jsx)(i.A,{value:"dart",label:"Dart",children:(0,r.jsx)(s.A,{language:"dart",children:b})}),f&&(0,r.jsx)(i.A,{value:"cli",label:"CLI",children:(0,r.jsx)(s.A,{language:"cli",children:f})})]}):null}},4445:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/read-aside-caching-cd1ed0bdbf8717c2f13ae0bbdba4168d.png"},3973:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/write-through-caching-8dd8ff7e33462c832af8d06219c544f9.png"}}]);